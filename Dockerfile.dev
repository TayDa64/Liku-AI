# =============================================================================
# Liku-AI Development Dockerfile
# For local development with hot reload
# =============================================================================

# Using Node 22 LTS Alpine with security updates
FROM node:22-alpine

# Update Alpine packages to get latest security patches
RUN apk upgrade --no-cache

# Install build dependencies for native modules
RUN apk add --no-cache python3 make g++

WORKDIR /app

# Copy package files
COPY package*.json ./

# Install all dependencies
RUN npm ci

# Copy source (will be overridden by volume mount in dev mode)
COPY . .

# Build TypeScript
RUN npm run build

# Environment
ENV NODE_ENV=development
ENV LIKU_WS_PORT=3847
ENV LIKU_WS_HOST=0.0.0.0

EXPOSE 3847

# Development command with watch mode
CMD ["npm", "run", "dev"]
